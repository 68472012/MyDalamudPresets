# 巨匠の水薬※動作未確認<br/>
Author: 小鳥遊レイ
<br/>
<br/>

## Description<br/>
クリスタリウムのリーヴ受注NPC「エイリクル」と納品NPC「モイス」の間に立って実行すると自動でリーヴ受注～納品を行います。<br/>
<br/>

### 金策用について<br/>
リーヴ券１枚ごとに最大回数(3回)納品します。<br/>
金策を目的とした一般的な挙動をするスクリプトです。<br/>
<br/>

### リーヴ回数ファーム用について<br/>
リーヴ券1枚ごとに1回だけ納品を行います。<br/>
アチーブメント「リーヴ好きの製作者：ランク7」の取得などの為に、より少ないアイテム数でリーヴの完了回数を増やすことを目的としたスクリプトです。<br/>
<br/>

### ループあり<br/>
アイテムの有無やリーヴ券の有無にかかわらず手動で停止するまで動作し続けます。<br/>
納品が完了したら`/snd stop`等を使用し、手動で停止してください。<br/>
Lua版の場合、納品アイテムが足りないときのみ自動停止します。<br/>
自動停止の際は、echoに「納品アイテムが不足しています」と出力されます。<br/>
リーヴ券が足りない場合は上記と同様に`/snd stop`等を使用し、手動で停止してください。<br/>
<br/>

### ループなし<br/>
リーヴ受注～納品を1回行うと停止します。<br/>
複数回納品する場合は必要な回数分、手動でスクリプトを実行してください。<br/>
Lua版も基本的な動作は同じですが、納品アイテムが足りない状態で実行した場合、echoに「納品アイテムが不足しています」と出力されるだけで停止するようになっています。<br/>
余分なリーヴ券を消費しないための処理です。<br/>
<br/>

## Required Plugins<br/>
スクリプトの稼働には以下のプラグイン、設定が必要です。<br/>

### YesAlready <br/>
1. Talkタブに以下のふたつを追加。<br/>
```
エイリクル
```
```
モイス
```
<br/>

2. (リーヴ回数ファーム用を使用する場合)YesNoタブに以下の文章を追加。
```
追加納品を行わず、任務を終了します。 本当によろしいですか？
```

### TextAdvance<br/>
以下の項目にチェックを入れる。<br/>
1.  General Config -> Plugin Operation -> Enable Plugin (non-persistent)<br/>
2.  General Config -> Functions -> Auto-confirm request handins (RH)<br/>
3.  General Config -> Functions -> Automatic request fill (RF)<br/>
<br/>

## スクリプト<br/>
### 金策用<br/>
(準備中)<br/>
<br/>

### リーヴ回数ファーム用<br/>
#### Native（ループあり）<!-- ※動作未確認 -->
```
/target エイリクル
/interact <wait.0.5>
/callback SelectString true 1 <wait.0.5>
/callback GuildLeve true 3 1489 <wait.0.5>
/callback GuildLeve true -1 <wait.0.5>
/callback SelectString true 3 <wait.0.5>
/target モイス
/interact <wait.1>
/callback JournalResult true 0 <wait.1>
/loop
```
#### Native（ループなし）<!-- ※動作未確認 -->
```
/target エイリクル
/interact <wait.0.5>
/callback SelectString true 1 <wait.0.5>
/callback GuildLeve true 3 1489 <wait.0.5>
/callback GuildLeve true -1 <wait.0.5>
/callback SelectString true 3 <wait.0.5>
/target モイス
/interact <wait.1>
/callback JournalResult true 0
```
#### Lua（ループあり）<!-- ※動作未確認 -->
```Lua
--所持品内にあるHQ納品物の数を確認し、3個以上あれば納品なければechoにテキスト出力
while Inventory.GetHqItemCount(27958) >= 3 do
    yield("/target エイリクル")
    yield("/interact <wait.0.5>")
    yield("/callback SelectString true 1 <wait.0.5>")
    yield("/callback GuildLeve true 3 1489 <wait.0.5>")
    yield("/callback GuildLeve true -1 <wait.0.5>")
    yield("/callback SelectString true 3 <wait.0.5>")
    yield("/target モイス")
    yield("/interact <wait.1>")
    yield("/callback JournalResult true 0 <wait.1>")
end
    yield("/e 納品アイテムが不足しています")
```
#### Lua（ループなし）<!-- ※動作未確認 -->
```Lua
-- 所持品内にあるHQ納品物の数を確認し、3個以上あれば納品なければechoにテキスト出力
if Inventory.GetHqItemCount(27958) < 3 then
    yield("/e 納品アイテムが不足しています")
else
    yield("/target エイリクル")
    yield("/interact <wait.0.5>")
    yield("/callback SelectString true 1 <wait.0.5>")
    yield("/callback GuildLeve true 3 1489 <wait.0.5>")
    yield("/callback GuildLeve true -1 <wait.0.5>")
    yield("/callback SelectString true 3 <wait.0.5>")
    yield("/target モイス")
    yield("/interact <wait.1>")
    yield("/callback JournalResult true 0")
end
```